Loading dataset...
Constructing network...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
/mnt/nvme/home/alex/repos/diffusion/edm/training/networks.py:166: UserWarning: ComplexHalf support is experimental and many operators don't support it yet. (Triggered internally at ../aten/src/ATen/EmptyTensor.cpp:31.)
  x_ft = torch.fft.rfft2(x)

EDMPrecond            Parameters  Buffers  Output shape       Datatype
---                   ---         ---      ---                ---     
model.map_noise       -           -        [16, 128]          float32 
model.map_layer0      66048       -        [16, 512]          float32 
model.map_layer1      262656      -        [16, 512]          float32 
model.enc.0_conv      212480      -        [16, 128, 32, 32]  float16 
model.enc.0_block0    18187136    -        [16, 128, 32, 32]  float16 
model.enc.0_block1    18187136    -        [16, 128, 32, 32]  float16 
model.enc.0_block2    18187136    -        [16, 128, 32, 32]  float16 
model.enc.0_block3    18187136    -        [16, 128, 32, 32]  float16 
model.enc.1_down      5096448     8        [16, 128, 16, 16]  float16 
model.enc.1_block0    15206144    -        [16, 256, 16, 16]  float16 
model.enc.1_block1    20186880    -        [16, 256, 16, 16]  float16 
model.enc.1_block2    20186880    -        [16, 256, 16, 16]  float16 
model.enc.1_block3    20186880    -        [16, 256, 16, 16]  float16 
model.enc.2_down      6621184     8        [16, 256, 8, 8]    float16 
model.enc.2_block0    6819072     -        [16, 256, 8, 8]    float16 
model.enc.2_block1    6819072     -        [16, 256, 8, 8]    float16 
model.enc.2_block2    6819072     -        [16, 256, 8, 8]    float16 
model.enc.2_block3    6819072     -        [16, 256, 8, 8]    float16 
model.enc.3_down      1378304     8        [16, 256, 4, 4]    float16 
model.enc.3_block0    1312512     -        [16, 256, 4, 4]    float16 
model.enc.3_block1    1312512     -        [16, 256, 4, 4]    float16 
model.enc.3_block2    1312512     -        [16, 256, 4, 4]    float16 
model.enc.3_block3    1312512     -        [16, 256, 4, 4]    float16 
model.dec.3_in0       1576192     -        [16, 256, 4, 4]    float16 
model.dec.3_in1       1312512     -        [16, 256, 4, 4]    float16 
model.dec.3_block0    2034176     -        [16, 256, 4, 4]    float16 
model.dec.3_block1    2034176     -        [16, 256, 4, 4]    float16 
model.dec.3_block2    2034176     -        [16, 256, 4, 4]    float16 
model.dec.3_block3    2034176     -        [16, 256, 4, 4]    float16 
model.dec.3_block4    2034176     -        [16, 256, 4, 4]    float16 
model.dec.2_up        1378304     8        [16, 256, 8, 8]    float16 
model.dec.2_block0    9898496     -        [16, 256, 8, 8]    float16 
model.dec.2_block1    9898496     -        [16, 256, 8, 8]    float16 
model.dec.2_block2    9898496     -        [16, 256, 8, 8]    float16 
model.dec.2_block3    9898496     -        [16, 256, 8, 8]    float16 
model.dec.2_block4    10162176    -        [16, 256, 8, 8]    float16 
model.dec.1_up        6621184     8        [16, 256, 16, 16]  float16 
model.dec.1_block0    30345728    -        [16, 256, 16, 16]  float16 
model.dec.1_block1    30345728    -        [16, 256, 16, 16]  float16 
model.dec.1_block2    30345728    -        [16, 256, 16, 16]  float16 
model.dec.1_block3    30345728    -        [16, 256, 16, 16]  float16 
model.dec.1_block4    25299200    -        [16, 256, 16, 16]  float16 
model.dec.0_up        20252672    8        [16, 256, 32, 32]  float16 
model.dec.0_block0    36357632    -        [16, 128, 32, 32]  float16 
model.dec.0_block1    27280640    -        [16, 128, 32, 32]  float16 
model.dec.0_block2    27280640    -        [16, 128, 32, 32]  float16 
model.dec.0_block3    27280640    -        [16, 128, 32, 32]  float16 
model.dec.0_block4    27280640    -        [16, 128, 32, 32]  float16 
model.dec.0_aux_norm  256         -        [16, 128, 32, 32]  float16 
model.dec.0_aux_conv  212355      -        [16, 3, 32, 32]    float16 
model                 1152        -        [16, 3, 32, 32]    float16 
<top-level>           -           -        [16, 3, 32, 32]    float32 
---                   ---         ---      ---                ---     
Total                 578122755   48       -                  -       

Setting up optimizer...
Training for 200000 kimg...

tick 0     kimg 0.1       time 19s          sec/tick 2.5     sec/kimg 19.81   maintenance 16.4   cpumem 3.27   gpumem 13.16  reserved 13.51 
tick 1     kimg 50.2      time 1m 57s       sec/tick 93.9    sec/kimg 1.88    maintenance 4.1    cpumem 3.80   gpumem 15.34  reserved 15.71 
tick 2     kimg 100.2     time 3m 30s       sec/tick 93.2    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 3     kimg 150.3     time 5m 04s       sec/tick 94.2    sec/kimg 1.88    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 4     kimg 200.3     time 6m 37s       sec/tick 93.0    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 5     kimg 250.4     time 8m 10s       sec/tick 92.9    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 6     kimg 300.4     time 9m 43s       sec/tick 92.6    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 7     kimg 350.5     time 11m 16s      sec/tick 92.9    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 8     kimg 400.5     time 12m 48s      sec/tick 92.7    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 9     kimg 450.6     time 14m 21s      sec/tick 92.5    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 10    kimg 500.6     time 15m 54s      sec/tick 93.5    sec/kimg 1.87    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 11    kimg 550.7     time 17m 27s      sec/tick 92.5    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 12    kimg 600.7     time 18m 59s      sec/tick 92.3    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 13    kimg 650.8     time 20m 31s      sec/tick 92.0    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 14    kimg 700.8     time 22m 03s      sec/tick 92.0    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 15    kimg 750.8     time 23m 37s      sec/tick 93.2    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 16    kimg 800.9     time 25m 09s      sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 17    kimg 850.9     time 26m 43s      sec/tick 94.3    sec/kimg 1.88    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 18    kimg 901.0     time 28m 16s      sec/tick 92.5    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 19    kimg 951.0     time 29m 48s      sec/tick 92.7    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 20    kimg 1001.1    time 31m 20s      sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 21    kimg 1051.1    time 32m 52s      sec/tick 91.7    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 22    kimg 1101.2    time 34m 25s      sec/tick 93.4    sec/kimg 1.87    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 23    kimg 1151.2    time 35m 58s      sec/tick 92.7    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 24    kimg 1201.3    time 37m 30s      sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 25    kimg 1251.3    time 39m 02s      sec/tick 91.8    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 26    kimg 1301.4    time 40m 37s      sec/tick 91.6    sec/kimg 1.83    maintenance 3.6    cpumem 3.80   gpumem 15.36  reserved 15.71 
tick 27    kimg 1351.4    time 42m 10s      sec/tick 92.5    sec/kimg 1.85    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 28    kimg 1401.5    time 43m 41s      sec/tick 91.0    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 29    kimg 1451.5    time 45m 13s      sec/tick 92.3    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 30    kimg 1501.6    time 46m 44s      sec/tick 91.1    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 31    kimg 1551.6    time 48m 16s      sec/tick 92.0    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 32    kimg 1601.7    time 49m 48s      sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 33    kimg 1651.7    time 51m 20s      sec/tick 91.8    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 34    kimg 1701.8    time 52m 52s      sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 35    kimg 1751.8    time 54m 24s      sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 36    kimg 1801.9    time 55m 56s      sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 37    kimg 1851.9    time 57m 28s      sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 38    kimg 1902.0    time 58m 59s      sec/tick 91.3    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 39    kimg 1952.0    time 1h 00m 31s   sec/tick 91.5    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 40    kimg 2002.0    time 1h 02m 02s   sec/tick 91.3    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 41    kimg 2052.1    time 1h 03m 34s   sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 42    kimg 2102.1    time 1h 05m 06s   sec/tick 91.7    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 43    kimg 2152.2    time 1h 06m 37s   sec/tick 91.5    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 44    kimg 2202.2    time 1h 08m 09s   sec/tick 91.3    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 45    kimg 2252.3    time 1h 09m 42s   sec/tick 93.0    sec/kimg 1.86    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 46    kimg 2302.3    time 1h 11m 13s   sec/tick 91.0    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 47    kimg 2352.4    time 1h 12m 45s   sec/tick 92.0    sec/kimg 1.84    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 48    kimg 2402.4    time 1h 14m 15s   sec/tick 90.9    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 49    kimg 2452.5    time 1h 15m 47s   sec/tick 91.4    sec/kimg 1.83    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 50    kimg 2502.5    time 1h 17m 18s   sec/tick 91.2    sec/kimg 1.82    maintenance 0.0    cpumem 3.80   gpumem 13.17  reserved 15.71 
tick 51    kimg 2552.6    time 1h 18m 53s   sec/tick 91.0    sec/kimg 1.82    maintenance 3.7    cpumem 4.09   gpumem 15.36  reserved 15.71 
tick 52    kimg 2602.6    time 1h 20m 24s   sec/tick 91.1    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 53    kimg 2652.7    time 1h 21m 55s   sec/tick 91.1    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 54    kimg 2702.7    time 1h 23m 27s   sec/tick 92.4    sec/kimg 1.85    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 55    kimg 2752.8    time 1h 24m 58s   sec/tick 91.0    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 56    kimg 2802.8    time 1h 26m 30s   sec/tick 91.2    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 57    kimg 2852.9    time 1h 28m 01s   sec/tick 91.8    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 58    kimg 2902.9    time 1h 29m 33s   sec/tick 91.5    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 59    kimg 2953.0    time 1h 31m 05s   sec/tick 91.7    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 60    kimg 3003.0    time 1h 32m 36s   sec/tick 91.6    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 61    kimg 3053.1    time 1h 34m 08s   sec/tick 91.8    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 62    kimg 3103.1    time 1h 35m 40s   sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 63    kimg 3153.2    time 1h 37m 11s   sec/tick 91.3    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 64    kimg 3203.2    time 1h 38m 43s   sec/tick 91.7    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 65    kimg 3253.2    time 1h 40m 15s   sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 66    kimg 3303.3    time 1h 41m 47s   sec/tick 91.4    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 67    kimg 3353.3    time 1h 43m 18s   sec/tick 91.1    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 68    kimg 3403.4    time 1h 44m 49s   sec/tick 91.3    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 69    kimg 3453.4    time 1h 46m 20s   sec/tick 90.9    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 70    kimg 3503.5    time 1h 47m 52s   sec/tick 92.1    sec/kimg 1.84    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 71    kimg 3553.5    time 1h 49m 23s   sec/tick 91.2    sec/kimg 1.82    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 72    kimg 3603.6    time 1h 50m 56s   sec/tick 93.0    sec/kimg 1.86    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 73    kimg 3653.6    time 1h 52m 28s   sec/tick 91.4    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 74    kimg 3703.7    time 1h 54m 00s   sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 75    kimg 3753.7    time 1h 55m 31s   sec/tick 91.4    sec/kimg 1.83    maintenance 0.0    cpumem 4.09   gpumem 13.17  reserved 15.71 
tick 76    kimg 3803.8    time 1h 57m 06s   sec/tick 91.8    sec/kimg 1.83    maintenance 3.4    cpumem 4.07   gpumem 15.36  reserved 15.71 
tick 77    kimg 3853.8    time 1h 58m 38s   sec/tick 91.5    sec/kimg 1.83    maintenance 0.0    cpumem 4.07   gpumem 13.17  reserved 15.71 
tick 78    kimg 3903.9    time 2h 00m 09s   sec/tick 91.3    sec/kimg 1.82    maintenance 0.0    cpumem 4.07   gpumem 13.17  reserved 15.71 
tick 79    kimg 3953.9    time 2h 01m 41s   sec/tick 91.4    sec/kimg 1.83    maintenance 0.0    cpumem 4.07   gpumem 13.17  reserved 15.71 
tick 80    kimg 4004.0    time 2h 03m 13s   sec/tick 91.9    sec/kimg 1.84    maintenance 0.0    cpumem 4.07   gpumem 13.17  reserved 15.71 

Aborted!

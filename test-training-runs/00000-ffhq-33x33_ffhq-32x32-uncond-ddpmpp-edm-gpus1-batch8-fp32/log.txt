Loading datasets...
Constructing network...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Initializing fourier layer...
Input has shape: torch.Size([8, 3, 32, 32])
Has nan: False
Out shape at block 0_conv: torch.Size([8, 128, 32, 32])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block0: torch.Size([8, 128, 32, 32])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block1: torch.Size([8, 128, 32, 32])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block2: torch.Size([8, 128, 32, 32])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block3: torch.Size([8, 128, 32, 32])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 8, 5, 2])
out_ft shape: torch.Size([8, 128, 16, 9, 2])
Spectral out x shape: torch.Size([8, 128, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 16, 16]), Spectral out size: torch.Size([8, 128, 16, 16])
Spec conv input, weights:  torch.Size([8, 128, 16, 16]) torch.Size([128, 128, 8, 5, 2])
out_ft shape: torch.Size([8, 128, 16, 9, 2])
Spectral out x shape: torch.Size([8, 128, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 16, 16]), Spectral out size: torch.Size([8, 128, 16, 16])
Out shape at block 1_down: torch.Size([8, 128, 16, 16])
Has nan: False
Spec conv input, weights:  torch.Size([8, 128, 16, 16]) torch.Size([128, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block0: torch.Size([8, 256, 16, 16])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block1: torch.Size([8, 256, 16, 16])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block2: torch.Size([8, 256, 16, 16])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block3: torch.Size([8, 256, 16, 16])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_down: torch.Size([8, 256, 8, 8])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block0: torch.Size([8, 256, 8, 8])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block1: torch.Size([8, 256, 8, 8])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block2: torch.Size([8, 256, 8, 8])
Has nan: False
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block3: torch.Size([8, 256, 8, 8])
Has nan: False
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_down: torch.Size([8, 256, 4, 4])
Has nan: False
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block0: torch.Size([8, 256, 4, 4])
Has nan: False
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block1: torch.Size([8, 256, 4, 4])
Has nan: False
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block2: torch.Size([8, 256, 4, 4])
Has nan: False
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block3: torch.Size([8, 256, 4, 4])
Has nan: False
res levels:  [[32, 32], [16, 16], [8, 8]]
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_in0: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_in1: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block0: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block1: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block2: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block3: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  None out_w:  None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 4, 4]), Spectral out size: None
Out shape at block 3_block4: torch.Size([8, 256, 4, 4])
Has nan: False
out_h:  8 out_w:  8
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: None
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: None
Out shape at block 2_up: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 8, 8]) torch.Size([512, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block0: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 8, 8]) torch.Size([512, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block1: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 8, 8]) torch.Size([512, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block2: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 8, 8]) torch.Size([512, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block3: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 8, 8]) torch.Size([512, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 8, 5, 2])
Spectral out x shape: torch.Size([8, 256, 8, 8])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 8, 8]), Spectral out size: torch.Size([8, 256, 8, 8])
Out shape at block 2_block4: torch.Size([8, 256, 8, 8])
Has nan: False
out_h:  16 out_w:  16
Spec conv input, weights:  torch.Size([8, 256, 8, 8]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 4, 3, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_up: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 16, 16]) torch.Size([512, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block0: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 16, 16]) torch.Size([512, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block1: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 16, 16]) torch.Size([512, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block2: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 512, 16, 16]) torch.Size([512, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block3: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 384, 16, 16]) torch.Size([384, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 16, 9, 2])
Spectral out x shape: torch.Size([8, 256, 16, 16])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 16, 16]), Spectral out size: torch.Size([8, 256, 16, 16])
Out shape at block 1_block4: torch.Size([8, 256, 16, 16])
Has nan: False
out_h:  32 out_w:  32
Spec conv input, weights:  torch.Size([8, 256, 16, 16]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 32, 17, 2])
Spectral out x shape: torch.Size([8, 256, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 32, 32]), Spectral out size: torch.Size([8, 256, 32, 32])
Spec conv input, weights:  torch.Size([8, 256, 32, 32]) torch.Size([256, 256, 8, 5, 2])
out_ft shape: torch.Size([8, 256, 32, 17, 2])
Spectral out x shape: torch.Size([8, 256, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 256, 32, 32]), Spectral out size: torch.Size([8, 256, 32, 32])
Out shape at block 0_up: torch.Size([8, 256, 32, 32])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 384, 32, 32]) torch.Size([384, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block0: torch.Size([8, 128, 32, 32])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 256, 32, 32]) torch.Size([256, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block1: torch.Size([8, 128, 32, 32])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 256, 32, 32]) torch.Size([256, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block2: torch.Size([8, 128, 32, 32])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 256, 32, 32]) torch.Size([256, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block3: torch.Size([8, 128, 32, 32])
Has nan: False
out_h:  None out_w:  None
Spec conv input, weights:  torch.Size([8, 256, 32, 32]) torch.Size([256, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Spec conv input, weights:  torch.Size([8, 128, 32, 32]) torch.Size([128, 128, 16, 9, 2])
out_ft shape: torch.Size([8, 128, 32, 17, 2])
Spectral out x shape: torch.Size([8, 128, 32, 32])
Spatial out nan: False, Spectral out nan: False
Spatial out size: torch.Size([8, 128, 32, 32]), Spectral out size: torch.Size([8, 128, 32, 32])
Out shape at block 0_block4: torch.Size([8, 128, 32, 32])
Has nan: False

EDMPrecond            Parameters  Buffers  Output shape      Datatype
---                   ---         ---      ---               ---     
model.map_noise       -           -        [8, 128]          float32 
model.map_layer0      66048       -        [8, 512]          float32 
model.map_layer1      262656      -        [8, 512]          float32 
model.enc.0_conv      224768      -        [8, 128, 32, 32]  float32 
model.enc.0_block0    19235712    -        [8, 128, 32, 32]  float32 
model.enc.0_block1    19235712    -        [8, 128, 32, 32]  float32 
model.enc.0_block2    19235712    -        [8, 128, 32, 32]  float32 
model.enc.0_block3    19235712    -        [8, 128, 32, 32]  float32 
model.enc.1_down      5620736     8        [8, 128, 16, 16]  float32 
model.enc.1_block0    16779008    -        [8, 256, 16, 16]  float32 
model.enc.1_block1    22284032    -        [8, 256, 16, 16]  float32 
model.enc.1_block2    22284032    -        [8, 256, 16, 16]  float32 
model.enc.1_block3    22284032    -        [8, 256, 16, 16]  float32 
model.enc.2_down      7669760     8        [8, 256, 8, 8]    float32 
model.enc.2_block0    7867648     -        [8, 256, 8, 8]    float32 
model.enc.2_block1    7867648     -        [8, 256, 8, 8]    float32 
model.enc.2_block2    7867648     -        [8, 256, 8, 8]    float32 
model.enc.2_block3    7867648     -        [8, 256, 8, 8]    float32 
model.enc.3_down      1378304     8        [8, 256, 4, 4]    float32 
model.enc.3_block0    1312512     -        [8, 256, 4, 4]    float32 
model.enc.3_block1    1312512     -        [8, 256, 4, 4]    float32 
model.enc.3_block2    1312512     -        [8, 256, 4, 4]    float32 
model.enc.3_block3    1312512     -        [8, 256, 4, 4]    float32 
model.dec.3_in0       1576192     -        [8, 256, 4, 4]    float32 
model.dec.3_in1       1312512     -        [8, 256, 4, 4]    float32 
model.dec.3_block0    2034176     -        [8, 256, 4, 4]    float32 
model.dec.3_block1    2034176     -        [8, 256, 4, 4]    float32 
model.dec.3_block2    2034176     -        [8, 256, 4, 4]    float32 
model.dec.3_block3    2034176     -        [8, 256, 4, 4]    float32 
model.dec.3_block4    2034176     -        [8, 256, 4, 4]    float32 
model.dec.2_up        1378304     8        [8, 256, 8, 8]    float32 
model.dec.2_block0    11471360    -        [8, 256, 8, 8]    float32 
model.dec.2_block1    11471360    -        [8, 256, 8, 8]    float32 
model.dec.2_block2    11471360    -        [8, 256, 8, 8]    float32 
model.dec.2_block3    11471360    -        [8, 256, 8, 8]    float32 
model.dec.2_block4    11735040    -        [8, 256, 8, 8]    float32 
model.dec.1_up        7669760     8        [8, 256, 16, 16]  float32 
model.dec.1_block0    33491456    -        [8, 256, 16, 16]  float32 
model.dec.1_block1    33491456    -        [8, 256, 16, 16]  float32 
model.dec.1_block2    33491456    -        [8, 256, 16, 16]  float32 
model.dec.1_block3    33491456    -        [8, 256, 16, 16]  float32 
model.dec.1_block4    27920640    -        [8, 256, 16, 16]  float32 
model.dec.0_up        22349824    8        [8, 256, 32, 32]  float32 
model.dec.0_block0    38454784    -        [8, 128, 32, 32]  float32 
model.dec.0_block1    28853504    -        [8, 128, 32, 32]  float32 
model.dec.0_block2    28853504    -        [8, 128, 32, 32]  float32 
model.dec.0_block3    28853504    -        [8, 128, 32, 32]  float32 
model.dec.0_block4    28853504    -        [8, 128, 32, 32]  float32 
model.dec.0_aux_norm  256         -        [8, 128, 32, 32]  float32 
model.dec.0_aux_conv  224643      -        [8, 3, 32, 32]    float32 
model                 1152        -        [8, 3, 32, 32]    float32 
<top-level>           -           -        [8, 3, 32, 32]    float32 
---                   ---         ---      ---               ---     
Total                 630576131   48       -                 -       

Traceback (most recent call last):
  File "/mnt/nvme/home/alex/repos/diffusion/edm/dnnlib/util.py", line 44, in __getattr__
    return self[name]
KeyError: 'finetune_spectral'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/nvme/home/alex/repos/diffusion/edm/train.py", line 241, in <module>
    main()
  File "/mnt/nvme/home/alex/.envs/diffusion/lib/python3.9/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/mnt/nvme/home/alex/.envs/diffusion/lib/python3.9/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
  File "/mnt/nvme/home/alex/.envs/diffusion/lib/python3.9/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/mnt/nvme/home/alex/.envs/diffusion/lib/python3.9/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/mnt/nvme/home/alex/repos/diffusion/edm/train.py", line 236, in main
    training_loop.training_loop(**c)
  File "/mnt/nvme/home/alex/repos/diffusion/edm/training/training_loop.py", line 90, in training_loop
    if optimizer_kwargs.finetune_spectral:
  File "/mnt/nvme/home/alex/repos/diffusion/edm/dnnlib/util.py", line 46, in __getattr__
    raise AttributeError(name)
AttributeError: finetune_spectral
